---
import { isActiveLink } from '../../utils/navigation';
import { isActiveProject, isActiveBlogCategory } from '../../utils/activeState';

interface Props {
    title: string;
    items: {
        href: string;
        label: string;
        isExternal?: boolean;
    }[];
}

const { title, items } = Astro.props;

const icons = {
    'Side Projects': `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M6 18h8"/>
        <path d="M3 22h18"/>
        <path d="M14 22a7 7 0 1 0 0-14h-1"/>
        <path d="M9 14h2"/>
    </svg>`,
    'Thoughts': `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
        <polyline points="14 2 14 8 20 8"/>
    </svg>`,
    'Bookshelf': `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/>
        <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/>
    </svg>`,
    'Bio': `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
        <circle cx="12" cy="7" r="4"/>
    </svg>`
};
---

<div class="nav-section">
    <h2 class="section-title">{title}</h2>
    <ul class="nav-list">
        {items.map(item => {
            const isProjectActive = item.href.startsWith('/projects/') && isActiveProject(item.href.split('/')[2]);
            const isBlogActive = item.href.startsWith('/blogs/') && isActiveBlogCategory(item.href.split('/')[2]);
            const isActive = isProjectActive || isBlogActive || isActiveLink(item.href);
            
            return (
                <li>
                    <a 
                        href={item.href} 
                        class={`nav-item ${isActive ? 'active' : ''}`}
                        {...(item.isExternal ? { target: "_blank", rel: "noopener noreferrer" } : {})}
                    >
                        <span class="nav-dot">â€¢</span>
                        {icons[item.label] && <span class="nav-icon" set:html={icons[item.label]} />}
                        {item.label}
                        {item.isExternal && (
                            <svg class="external-arrow" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M3.5 3C3.5 2.72386 3.72386 2.5 4 2.5H8.5C8.77614 2.5 9 2.72386 9 3V7.5C9 7.77614 8.77614 8 8.5 8C8.22386 8 8 7.77614 8 7.5V4.20711L3.35355 8.85355C3.15829 9.04882 2.84171 9.04882 2.64645 8.85355C2.45118 8.65829 2.45118 8.34171 2.64645 8.14645L7.29289 3.5H4C3.72386 3.5 3.5 3.27614 3.5 3Z" fill="currentColor"/>
                            </svg>
                        )}
                    </a>
                </li>
            );
        })}
    </ul>
</div>

<style>
    .nav-section {
        margin-top: var(--space-lg);
    }
    .section-title {
        color: var(--color-text-secondary);
        font-size: 0.875rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        padding: var(--space-xs) var(--space-sm);
    }
    .nav-list {
        list-style: none;
        margin-top: var(--space-xs);
    }
    .nav-item {
        display: flex;
        align-items: center;
        color: var(--color-text-secondary);
        text-decoration: none;
        padding: var(--space-sm) var(--space-md);
        border-radius: 6px;
        transition: var(--transition-default);
        font-size: var(--text-lg);
        font-weight: 500;
    }
    .nav-dot {
        opacity: 0;
        margin-right: var(--space-sm);
        transition: var(--transition-default);
    }
    .nav-icon {
        margin-right: var(--space-sm);
        display: flex;
        align-items: center;
    }
    .nav-item:hover,
    .nav-item.active {
        color: var(--color-text-primary);
        background-color: var(--color-bg-secondary);
    }
    .nav-item:hover .nav-dot,
    .nav-item.active .nav-dot {
        opacity: 1;
        color: var(--color-accent);
    }
    .external-arrow {
        margin-left: var(--space-xs);
        opacity: 0.6;
        transition: transform 0.2s ease;
    }
    .nav-item:hover .external-arrow {
        transform: translate(2px, -2px);
        opacity: 1;
    }
</style>